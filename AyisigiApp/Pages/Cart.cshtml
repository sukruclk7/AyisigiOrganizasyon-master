@page "/cart"
@model CartModel

<div class="container my-5">

    <h2 class="text-center text-light mb-4 fw-bold">
        <i class="fa fa-shopping-cart text-warning"></i> Sepetiniz
    </h2>

    @if (!(Model.Cart?.Lines.Any() ?? false))
    {
        <div class="empty-cart text-center py-5">
            <i class="fa-solid fa-box-open text-warning" style="font-size:48px;"></i>
            <h4 class="text-light mt-3">Sepetiniz Boş</h4>
            <a href="@Model.ReturnUrl" class="btn btn-warning mt-3">
                Alışverişe Devam Et
            </a>
        </div>

        <style>
            .empty-cart {
                background: #1b1b1b;
                border-radius: 14px;
            }
        </style>

        return;
    }

    <div class="card cart-card shadow-lg">
        <div class="card-body p-0">

            <table class="table table-dark table-hover align-middle mb-0">
                <thead class="table-header">
                    <tr>
                        <th>Ürün</th>
                        <th class="text-center">Adet</th>
                        <th class="text-center">Fiyat</th>
                        <th class="text-center">Ara Toplam</th>
                        <th></th>
                    </tr>
                </thead>

                <tbody>
                    @foreach (var line in Model.Cart?.Lines ?? Enumerable.Empty<CartLine>())
                    {
                        <tr>
                            <td class="fw-semibold">@line.Product.ProductName</td>

                            <td class="text-center">@line.Quantity</td>

                            <td class="text-center text-warning fw-bold">
                                @line.Product.ProductPrice.ToString("C2")
                            </td>

                            <td class="text-center text-success fw-bold">
                                @((line.Product.ProductPrice * line.Quantity).ToString("C2"))
                            </td>

                            <td class="text-end">
                                <form method="post" asp-page-handler="Remove" class="d-inline">
                                    <input type="hidden" name="id" value="@line.Product.ProductId" />
                                    <input type="hidden" name="returnUrl" value="@Model.ReturnUrl" />

                                    <button type="submit" class="btn btn-sm btn-outline-danger">
                                        <i class="fa fa-trash"></i>
                                    </button>
                                </form>
                            </td>
                        </tr>
                    }
                </tbody>

                <tfoot>
                    <tr class="table-footer">
                        <td colspan="3" class="text-end fw-bold">Toplam:</td>
                        <td class="text-center text-warning fw-bold fs-5">
                            @Model.Cart?.ComputeTotalValue().ToString("C2")
                        </td>
                        <td></td>
                    </tr>
                </tfoot>

            </table>

        </div>
    </div>

    <div class="text-center mt-4">
        <div class="btn-group">

            <a href="@Model.ReturnUrl" class="btn btn-outline-warning">
                <i class="fa fa-arrow-left"></i> Alışverişe Devam Et
            </a>

            <a asp-action="Checkout" asp-controller="Order" class="btn btn-warning mx-2 fw-bold">
                <i class="fa fa-check-circle"></i> Alışverişi Tamamla
            </a>

        </div>
    </div>

</div>


<style>
    .cart-card {
        background: #1a1a1a;
        border: 1px solid #333;
        border-radius: 12px;
    }

    .table-header {
        background: #111;
        border-bottom: 2px solid #ffc10755;
    }

    .table-footer {
        background: #111;
        border-top: 2px solid #ffc10755;
    }

    .table-dark td, .table-dark th {
        color: #ddd;
    }

    .btn-outline-danger:hover {
        background: #dc3545;
        color: #fff;
    }

    .btn-outline-warning:hover {
        background: #ffc107;
        color: #111;
    }
</style>
